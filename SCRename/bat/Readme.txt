[概要]

録画終了後，自動的にファイルのフォルダ分け，リネームを行うための
SCRename補助バッチファイルです．録画ファイルの保存先はリネーム元のフォルダを基準として
｢ジャンル名\番組名\録画ファイル｣となります．フォルダの作成，ファイルの移動，リネームには
SCRenameを使用しており，ProgramTitle.vbsもSCRenameを参考にさせていただいています.
SCRename作者様にはこの場を借りて御礼申し上げます．

[設定]

<TvRock>

1. 	SCRenameをDTV関係ツール(http://2sen.dip.jp/dtv/)のDTVアップローダから
	最新版(2011/08/25現在で4.8)をダウンロードしインストールする．インストール方法は
	SCRename付属のReadme.txtを参照してください．4.7以下では正常に動作しません．
2.	TvRock.batの4行目にある｢REM 環境変数｣の下2行を自分の環境にあわせ修正する．
	｢SCRPATH｣はSCRenameのインストールフォルダ．｢SCRIPTSPATH｣はScriptsフォルダを設置するフォルダ．
3.	TvRock.batとScriptsフォルダをお好きな場所に置く．
	(TvRock.batとScriptsフォルダを同じ階層に置くことを推奨)
4.	TvRock の「ファイル名置換フォーマット」の設定で「@YY@MM@DD@SH@SM_@TT _@CH」にする．
5. 	TvRock の「コマンドを実行する」の設定で以下の2行を設定する．
	未視聴:D:\Users\Software\PT2\TvRock\TvRock.bat "%1" "%c" "1"
	TN:D:\Users\Software\PT2\TvRock\TvRock.bat "%1" "%c"
	(TvRock.batまでのパスは自分の設置したフォルダまでのパス)
	(第一引数の%1がファイル名のフルパス，第二引数の%cがジャンル名，第三引数がオプション)

[ファイル構成]

TvRock.bat:
メインとなるバッチファイルです．

ProgramTitle.vbs:
｢しょぼいカレンダー｣に載っていない番組の番組名を取得するためのプログラムです．

PTitle.prg:
｢しょぼいカレンダー｣に載っていない番組を番組名でフォルダ分けするために番組名を定義するファイルです．
ProgramTitle.vbsで使用します．
フォルダ分けしたい番組名を｢番組表内のワード,番組名フォルダ｣となるように記入します．各行に記載された文字列のいずれかを含む場合にヒットします．
先頭に｢:｣をつけるとその行は無視されます.
PTitle.prgで番組名がヒットした場合は｢しょぼいカレンダー｣に載っている番組であっても載っていないとして
処理されますのでご注意ください．

[使用方法]

TvRock.bat "ファイル" "ジャンル名" "オプション(指定しない場合はオプション無しと判断)"

このように引数を与えられるのであればTvRock以外でも使用できます．

<ファイル>
ファイル名の書式に関してはSCRenameのReadme.txtを参照してください．
[設定]での｢ファイル名置換フォーマット｣では下記のように指定しています．

YYMMDDhhmm_番組名 _放送局名.拡張子

[動作]
1.	ジャンル名を簡略化
	｢アニメ／特撮｣を｢アニメ｣，｢ニュース／報道｣を｢ニュース｣といったように長いジャンル名を
	短いジャンル名に置き換えています．TvRock.batの17行目から22行目のジャンル名変更という部分を
	追加削除修正を行うことで，任意をジャンル名にすることが出来ます．
2.	オプション｢未視聴｣
	TvRockの予約時に録画終了後コマンドで未視聴を選択するとフォルダ構成が
	｢ジャンル名\未視聴\番組名\｣となります．録画しているが見ていないアニメなどに
	このオプションを利用することを想定しています．このオプションは第三引数で1を指定すると実行されます．
3.	ファイルのリネーム後移動
	｢しょぼいカレンダー｣に載っている番組に関しては録画ファイルの保存先は｢ジャンル名\番組名\録画ファイル｣
	となります．ファイル名は｢DOG DAYS 第01話 「勇者誕生！」 (tvk).ts｣のようになります．TvRock.batの
	41行目(SCRENAME1)を書き換えることで変更することが可能です．
	｢しょぼいカレンダー｣に載っていない番組に関してはPTitle.prgに一致する番組名があるかどうか検索し
	見つかった場合録画ファイルの保存先は｢ジャンル名\番組名\｣となります．
	ファイル名は｢連続テレビ小説 おひさま（6）「母のナミダ」 (2011.04.09 NHK-G).ts｣のようになります．
	TvRock.batの47行目(SCRENAME2)を書き換えることで変更することが可能です．
	PTitle.prgでの検索で番組名が見つからなかった場合の録画ファイルの保存先は
	｢ジャンル名\｣となります．
	
[SCRENAME2に関して]
SCRENAME2を書き換えることでファイル名のフォーマットを変えることができます．
48行目の括弧内を編集してください．
使用している書式はSCRenameのものですので詳しくはSCRenameのReadme.txtを参照してください．
TvRock.batで追加された書式は以下のものです.
%GENRE%			簡略化されたジャンル名
%TITLE%			PTitle.prgに一致した番組の番組名
%OUTPUTFOLDER%	%GENRE%(\未視聴)\(%TITLE)をひとつにまとめたもの．
注:\未視聴の有無はOPTIONの1が指定されているかどうかで決まります．
	%TITLE%はPTitle.prgで一致する番組名がなかった場合表示されません．

･連続テレビ小説 おひさま（6）「母のナミダ」 (2011.04.09 NHK-G).ts
	"%OUTPUTFOLDER%\$SCtitle$ ($SCyear2$.$SCmonth$.$SCday$ $SCservice$)"
･連続テレビ小説 おひさま（6）「母のナミダ」 (20110409 NHK-G).ts
	"%OUTPUTFOLDER%\$SCtitle$ ($SCdate2$ $SCservice$)"
	
[注意点および免責事項]
このプログラムの使用または使用不可によって，いかなる問題が生じた場合も責任を負いません．
環境によっては動作しない場合が考えられます．予めご了承ください．

[不具合・要望等]

餅と輪(http://blog.mochiring.net/)

[改変履歴]
Ver. 1.1
	SCRename4.8に対応．

Ver. 1.0
	初版．

	

